# Broken Access Control

- Explain how common weakness can let users bypass authorization.
- Implement validation for user input that affects business logic.
- Prevent people in a system from using unauthorized functionality.

Broken access control  refers to common weakness that can lead to users bypassing the authorization needed to execute certain functions. This includes creating, deleting, accessing or updating records.

Its important to control who has access to particular features of the system to prevent attackers from getting hold of sensitive resources.

## Authentication vs Authorizations

Authentication is the method of verifying theidentity before letting you in.

Authorization is the method of giving access to functionalities after authenication. eg. Admin will have more authorization of servicves than others.

### Server-side checks
- input should be validated and revalidated to prevent undepectred consequewnces.
- Need to have a central security check to protect against malicious input like injection and another check to validate business rules.
- Client side validation should only be used for performance and user experience and is not a reliable validation method. There should be a server side validation in place.

### Privilege Escalation

- User gaining unauthorized access to data or functionality that isn't meant for their level of access.

#### Horizontal privilege escalation exploit

Example of this is when a user can access other people's profile on the same acecss level (previliege) by modifying some contents in the webpage or URL. For example :https:\\somesite.com?user=222. With Horizontal privilege escalation exploit users can manipulate the user id and access other people's information within the same access level. This is called Horizontal privilege escalation exploit.

#### Vertical privilege escalation exploit

It is similar to the horizontal pevitilege escalation exploit but the difference is the users can not access contents that are in higher access level. For example, a regular user can access admin previeleges using this exploit. Example: if a adming link is hidden using a client side script, someone can insepct the contents and modify it to gain access by enabling the link. If the server side validation is not done properly, a user can have access to the admin level privileges.

#### Insecure direct object reference

Insecure direct object references are caused by not validating tuser input that affcts business logic. It happens when attackers modify values, like URLs, that lead to results developers might not expect.

To prevent this we can use the sessions so that the URL's values cannot be exposed and tampered with. If parameters are sensitive and you do not want anyone modifying the while still keeping track of them. You can use session variables. Storing infomration in session variables stores them on the server side for each user, and pevenets attackers from tampering with URL parameters in the first place.

In addition to this, make sure you disable unused URL schemas, such as file://, dict://, ftp:// abd gopher://. This prevents attackers from exploiting SSRF( Server side request forgery) using poepentailly dangerous legacy schemas.

#### Missing funtion level access control

Function level access control prevents people in a system from using functionality and resources they shouldn't have access to. If these contorls are missing, attackers can exploit functionalities or everyday people can missue them.

eg: Manage users, delete users or manage pages should have function level access control.

This vulnerability can be exposed if the application doesn't properly restrict access to privileged functions. Two examples of how a user could take advantage of this weakness is by forced browsing and parameter manipulation.

Forced Browsing: Fubdubg /gyessubg the URL of a privileged action or area.
Parameter Manipulation: modfying a parameter for hidden action.

#### What is Cross-Site Request Forgery (CSRF)

In Cross-Site Request Forgery requests that are not verified by web servers can be exploited by attackers. This is also known as "See-Surf".

The applications may be at risk of CSRF if:

- it performs state changing operations on the backend, such as logins and storing data.
- it relies on authentication or session management handled by your browser, such as cookie or HTTP basic authentication.

##### Defend against CSRF

- Use anti-CSRF tokens generated by a library when your application generates dynamic pages. such as wth PHP and JSP.
- COSRS Policy: Use a secure Cross-Origin Resource Sharing policy if your application ccepts requests that can be setn from an HTML element. like a form.
- Use SameSite cookies when your application only needs to accept requestrs from the same domain.

## Summary

- Broken access control can lead to users bypassing authorization to use functions like creating, accessing and deleting records.
- Use server-side checks and variables to prevent attackers from tampering with parameters.
- Use page level authorization to verify users before they can access a page, or programmed suthorizatin to define roles and privileges for users.
- Use anti-CSRF tokens, create a suecure CORS policy, our use SameSIte cookies.